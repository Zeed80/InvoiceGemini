# ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ TrOCR –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ —Å LLM Gemini

## üéØ –û–±–∑–æ—Ä

InvoiceGemini —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ TrOCR –¥–∞—Ç–∞—Å–µ—Ç–æ–≤** —Å –ø–æ–º–æ—â—å—é LLM Gemini 2.0 Flash! –≠—Ç–∞ —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

- üìù **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** –∏ —Å–æ–∑–¥–∞–µ—Ç OCR –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏
- üéØ **–í—ã–ø–æ–ª–Ω—è–µ—Ç NER —Ä–∞–∑–º–µ—Ç–∫—É** (Named Entity Recognition) –¥–ª—è —Å—á–µ—Ç–æ–≤ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤  
- üé® **–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã** –≤—ã—Å–æ–∫–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞
- üîç **–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ** —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π
- ‚ö° **–£—Å–∫–æ—Ä—è–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ –≤ 10+ —Ä–∞–∑**

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ß–µ—Ä–µ–∑ GUI InvoiceGemini

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –¥–∏–∞–ª–æ–≥ –æ–±—É—á–µ–Ω–∏—è**: `–ú–µ–Ω—é ‚Üí –û–±—É—á–µ–Ω–∏–µ ‚Üí –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π`
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É**: `üìä TrOCR –î–∞—Ç–∞—Å–µ—Ç`
3. **–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º**: `ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º (LLM)`
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** LLM –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
5. **–ù–∞–∂–º–∏—Ç–µ**: `üöÄ –°–æ–∑–¥–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç`

### 2. –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ

```python
from app.training.enhanced_trocr_dataset_preparator import (
    create_automated_trocr_dataset,
    EnhancedTrOCRConfig
)

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
config = EnhancedTrOCRConfig(
    enable_llm_annotation=True,
    llm_model="models/gemini-2.0-flash-exp",
    max_llm_requests_per_minute=60,
    llm_confidence_threshold=0.8
)

# –°–æ–∑–¥–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
datasets = create_automated_trocr_dataset(
    source_images=["image1.jpg", "image2.png"],
    output_path="data/automated_trocr_dataset",
    num_synthetic=500,
    config=config
)
```

### 3. –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è

```bash
python demo_automated_trocr_dataset.py
```

## üîß –†–µ–∂–∏–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

### üìù –†—É—á–Ω–æ–π —Ä–µ–∂–∏–º
- –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è LLM
- –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π
- –°–æ–≤–º–µ—Å—Ç–∏–º —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏

### ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- LLM Gemini –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –°–æ–∑–¥–∞–µ—Ç –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ OCR –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è + —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
- –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏

### üéØ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º
- LLM —Å–æ–∑–¥–∞–µ—Ç –≤–µ—Å—å –¥–∞—Ç–∞—Å–µ—Ç —Å –Ω—É–ª—è
- –í–∫–ª—é—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏
- –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è

## üß† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ LLM

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–æ–¥–µ–ª–∏
- ‚úÖ **Google Gemini 2.0 Flash** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- ‚úÖ **Google Gemini 1.5 Pro**
- ‚úÖ **Google Gemini 1.5 Flash**
- ‚úÖ **OpenAI GPT-4o**
- ‚úÖ **Anthropic Claude 3.5 Sonnet**

### –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã

#### OCR –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è
```
data/prompts/trocr_llm_annotation_prompt.txt
```
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–ª–æ–≤ —Å bounding boxes
- NER —Ä–∞–∑–º–µ—Ç–∫–∞ (SUPPLIER, CUSTOMER, AMOUNT, DATE, etc.)
- –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ confidence

#### –°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
```
data/prompts/trocr_synthetic_generation_prompt.txt
```
- –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ (invoice, receipt, document, form)
- –†–æ—Å—Å–∏–π—Å–∫–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è (–ò–ù–ù, –ö–ü–ü, —Ä—É–±–ª–∏)

## üìä –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### EnhancedTrOCRConfig

```python
@dataclass
class EnhancedTrOCRConfig(TrOCRDatasetConfig):
    # LLM –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    enable_llm_annotation: bool = True
    llm_provider: str = "gemini"
    llm_model: str = "models/gemini-2.0-flash-exp"
    max_llm_requests_per_minute: int = 60
    llm_confidence_threshold: float = 0.8
    
    # OCR —Ä–∞–∑–º–µ—Ç–∫–∞
    ocr_languages: List[str] = ["ru", "en"]
    extract_bounding_boxes: bool = True
    min_word_confidence: float = 0.5
    use_layout_analysis: bool = True
    
    # –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö
    enable_quality_filter: bool = True
    min_text_length_chars: int = 3
    max_text_length_chars: int = 500
    filter_non_text_images: bool = True
    
    # –°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
    synthetic_templates: List[str] = ["invoice", "receipt", "document"]
    enable_document_layout_augmentation: bool = True
    enable_text_style_variation: bool = True
```

## üé® –°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–æ–≤

```python
synthetic_generator = SyntheticDataGenerator(config, logger)
synthetic_pairs = synthetic_generator.generate_synthetic_dataset(
    output_dir=Path("output"),
    num_samples=1000
)
```

### –¢–∏–ø—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **üìÑ Invoice**: –°—á–µ—Ç–∞-—Ñ–∞–∫—Ç—É—Ä—ã —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –ø–æ–ª–µ–π
- **üßæ Receipt**: –ß–µ–∫–∏ —Å —Ç–æ–≤–∞—Ä–∞–º–∏ –∏ —Å—É–º–º–∞–º–∏  
- **üìù Document**: –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- **üìã Form**: –§–æ—Ä–º—ã –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
- **üìä Table**: –¢–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
- üé® –í–∞—Ä–∏–∞—Ü–∏—è —à—Ä–∏—Ñ—Ç–æ–≤ –∏ —Ä–∞–∑–º–µ—Ä–æ–≤
- üåà –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤ –∏ —Ñ–æ–Ω–æ–≤
- üîÑ –ü–æ–≤–æ—Ä–æ—Ç—ã –∏ –∏—Å–∫–∞–∂–µ–Ω–∏—è
- üìê –†–∞–∑–ª–∏—á–Ω—ã–µ –º–∞–∫–µ—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## üîç –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **Confidence scoring**: –û—Ü–µ–Ω–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏
- **Text length validation**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞
- **Bbox validation**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç bounding boxes
- **Language detection**: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ —Ç–µ–∫—Å—Ç–∞
- **Layout analysis**: –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
```json
{
  "quality_metrics": {
    "overall_confidence": 0.92,
    "text_clarity": "excellent",
    "image_quality": "high", 
    "ocr_accuracy_estimate": 0.95,
    "recommended_for_training": true
  }
}
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–æ–≤ —Å –Ω–∏–∑–∫–∏–º confidence
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É —Ç–µ–∫—Å—Ç–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –°–∫–æ—Ä–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
- **–†—É—á–Ω–æ–π —Ä–µ–∂–∏–º**: 1-2 –ø—Ä–∏–º–µ—Ä–∞/—á–∞—Å ‚è±Ô∏è
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π**: 50-100 –ø—Ä–∏–º–µ—Ä–æ–≤/—á–∞—Å üöÄ
- **–ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π**: 200-500 –ø—Ä–∏–º–µ—Ä–æ–≤/—á–∞—Å ‚ö°

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- Rate limiting –¥–ª—è —Å–æ–±–ª—é–¥–µ–Ω–∏—è –ª–∏–º–∏—Ç–æ–≤ API
- Batch processing –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
- Retry –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üõ†Ô∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
EnhancedTrOCRDatasetPreparator
‚îú‚îÄ‚îÄ LLMAnnotationEngine
‚îÇ   ‚îú‚îÄ‚îÄ Gemini API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ Rate limiting
‚îÇ   ‚îî‚îÄ‚îÄ Validation
‚îú‚îÄ‚îÄ SyntheticDataGenerator  
‚îÇ   ‚îú‚îÄ‚îÄ Template engine
‚îÇ   ‚îú‚îÄ‚îÄ Image generation
‚îÇ   ‚îî‚îÄ‚îÄ Augmentation
‚îî‚îÄ‚îÄ QualityAnalyzer
    ‚îú‚îÄ‚îÄ Confidence scoring
    ‚îú‚îÄ‚îÄ Metadata extraction
    ‚îî‚îÄ‚îÄ Statistics
```

### –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è

```mermaid
graph TD
    A[–ò—Å—Ö–æ–¥–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è] --> B[LLM –∞–Ω–∞–ª–∏–∑]
    B --> C[OCR –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏]
    C --> D[–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞]
    D --> E[–°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è]
    E --> F[–ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö]
    F --> G[–°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞]
    G --> H[–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞]
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```
automated_trocr_dataset/
‚îú‚îÄ‚îÄ train/
‚îÇ   ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îú‚îÄ‚îÄ annotations/
‚îÇ   ‚îî‚îÄ‚îÄ metadata.json
‚îú‚îÄ‚îÄ validation/
‚îÇ   ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îú‚îÄ‚îÄ annotations/
‚îÇ   ‚îî‚îÄ‚îÄ metadata.json
‚îú‚îÄ‚îÄ test/
‚îÇ   ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îú‚îÄ‚îÄ annotations/
‚îÇ   ‚îî‚îÄ‚îÄ metadata.json
‚îú‚îÄ‚îÄ enhanced_metadata.json
‚îú‚îÄ‚îÄ quality_report.json
‚îî‚îÄ‚îÄ synthetic_images/
```

### –§–æ—Ä–º–∞—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π

```json
{
  "words": ["–û–û–û", "–†–æ–≥–∞", "–∏", "–∫–æ–ø—ã—Ç–∞", "–°—á–µ—Ç", "‚Ññ", "12345"],
  "bboxes": [[10,20,50,40], [55,20,95,40], ...],
  "labels": ["B-SUPPLIER", "I-SUPPLIER", "I-SUPPLIER", "I-SUPPLIER", "O", "O", "B-INVOICE_NUMBER"],
  "confidence_scores": [0.95, 0.98, 0.92, ...],
  "full_text": "–û–û–û –†–æ–≥–∞ –∏ –∫–æ–ø—ã—Ç–∞ –°—á–µ—Ç ‚Ññ12345",
  "quality_metrics": {
    "overall_confidence": 0.94,
    "recommended_for_training": true
  }
}
```

## üéØ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–µ–π
1. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á Google Gemini
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤ InvoiceGemini: `–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏—Å—Ö–æ–¥–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (300+ DPI)
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ confidence threshold (0.7-0.9)
- –í–∫–ª—é—á–∏—Ç–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∫–∞—á–µ—Å—Ç–≤–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ layout analysis –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

### –≠–∫–æ–Ω–æ–º–∏—è API –∑–∞–ø—Ä–æ—Å–æ–≤
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–∞–∑—É–º–Ω—ã–π rate limit (30-60 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (384x384 –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)
- –ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É —Å—Ö–æ–∂–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –î–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ batch processing
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API –∫–≤–æ—Ç
- –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ API –∫–ª—é—á–µ–π
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### "API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
```bash
# –†–µ—à–µ–Ω–∏–µ: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ API –∫–ª—é—á –≤ InvoiceGemini
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã ‚Üí Google Gemini
```

#### "–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤"
```python
# –†–µ—à–µ–Ω–∏–µ: –£–º–µ–Ω—å—à–∏—Ç–µ rate limit
config.max_llm_requests_per_minute = 30
```

#### "–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π"
```python
# –†–µ—à–µ–Ω–∏–µ: –ü–æ–≤—ã—Å—å—Ç–µ –ø–æ—Ä–æ–≥ confidence
config.llm_confidence_threshold = 0.9
config.enable_quality_filter = True
```

#### "–û—à–∏–±–∫–∏ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª–µ–π"
```bash
# –†–µ—à–µ–Ω–∏–µ: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install google-generativeai transformers torch
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞

```python
import logging
logging.basicConfig(level=logging.DEBUG)

# –í–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
preparator = EnhancedTrOCRDatasetPreparator(config)
```

## üìö –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```python
from app.training.enhanced_trocr_dataset_preparator import create_automated_trocr_dataset

# –ü—Ä–æ—Å—Ç–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞
datasets = create_automated_trocr_dataset(
    source_images=["invoice1.jpg", "invoice2.pdf"],
    output_path="my_dataset",
    num_synthetic=100
)
```

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```python
from app.training.enhanced_trocr_dataset_preparator import (
    EnhancedTrOCRDatasetPreparator,
    EnhancedTrOCRConfig
)

# –ö–∞—Å—Ç–æ–º–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
config = EnhancedTrOCRConfig(
    llm_model="models/gemini-1.5-pro",
    max_llm_requests_per_minute=120,
    llm_confidence_threshold=0.9,
    image_size=(512, 512),
    enable_document_layout_augmentation=True,
    synthetic_templates=["invoice", "receipt", "contract"]
)

# –°–æ–∑–¥–∞–Ω–∏–µ —Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
preparator = EnhancedTrOCRDatasetPreparator(config)
datasets = preparator.prepare_fully_automated_dataset(
    source_images=image_list,
    output_path="advanced_dataset",
    num_synthetic=1000,
    progress_callback=lambda p: print(f"Progress: {p}%")
)
```

### –¢–æ–ª—å–∫–æ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
```python
config = EnhancedTrOCRConfig(
    enable_llm_annotation=True,
    synthetic_templates=["invoice", "receipt"]
)

datasets = create_automated_trocr_dataset(
    source_images=[],  # –ë–µ–∑ –∏—Å—Ö–æ–¥–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    output_path="synthetic_only_dataset", 
    num_synthetic=2000,
    config=config
)
```

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- üéØ **–ú—É–ª—å—Ç–∏-LLM –ø–æ–¥—Ö–æ–¥**: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π
- üîÑ **–ê–∫—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ**: –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞
- üìä **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞**: –î–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
- üåê **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞
- ‚ö° **GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è CUDA
- üîó **API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: REST API –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- **Self-supervised learning**: –£–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Ä–∞–∑–º–µ—Ç–∫–∏
- **Few-shot learning**: –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ –Ω–æ–≤—ã–º —Ç–∏–ø–∞–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **Multi-modal fusion**: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **Domain adaptation**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–º –¥–æ–º–µ–Ω–∞–º

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–º–æ—â–∏
- üìñ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: [PLUGIN_SYSTEM_GUIDE.md](PLUGIN_SYSTEM_GUIDE.md)
- üêõ **–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–∞—Ö**: GitHub Issues
- üí¨ **–û–±—Å—É–∂–¥–µ–Ω–∏—è**: GitHub Discussions
- üìß **–ö–æ–Ω—Ç–∞–∫—Ç—ã**: –ß–µ—Ä–µ–∑ –ø—Ä–æ—Ñ–∏–ª—å –ø—Ä–æ–µ–∫—Ç–∞

### –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç
- üîß **Pull Requests**: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è —É–ª—É—á—à–µ–Ω–∏—è
- üìù **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –ü–æ–º–æ—â—å —Å –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- üí° **–ò–¥–µ–∏**: –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ TrOCR –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ —Å LLM Gemini - —ç—Ç–æ **—Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–π —à–∞–≥** –≤ —Ä–∞–∑–≤–∏—Ç–∏–∏ InvoiceGemini. –≠—Ç–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è:

- ‚ö° **–£—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É** –≤ 10+ —Ä–∞–∑
- üéØ **–ü–æ–≤—ã—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ** –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
- ü§ñ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç —Ä—É—Ç–∏–Ω—É** —Ä–∞–∑–º–µ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- üöÄ **–û—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏** –¥–ª—è ML —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

**–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–∂–µ —Å–µ–≥–æ–¥–Ω—è** –∏ –æ—â—É—Ç–∏—Ç–µ –º–æ—â—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Å –ò–ò!

```bash
python demo_automated_trocr_dataset.py
```

*–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –∫–æ–º–∞–Ω–¥–æ–π InvoiceGemini* 