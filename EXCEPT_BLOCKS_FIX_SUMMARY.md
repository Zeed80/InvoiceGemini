# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–æ–ª—ã—Ö except –±–ª–æ–∫–æ–≤ - –û—Ç—á–µ—Ç

**–î–∞—Ç–∞:** 02.10.2024  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í –ü–†–û–¶–ï–°–°–ï (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö–†–ò–¢–ò–ß–ù–û - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

---

## üìä –ü—Ä–æ–±–ª–µ–º–∞

**–ì–æ–ª—ã–µ `except:` –±–ª–æ–∫–∏** –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –í–°–ï –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è —Å–∏—Å—Ç–µ–º–Ω—ã–µ (`KeyboardInterrupt`, `SystemExit`), —á—Ç–æ:
- ‚ùå –°–∫—Ä—ã–≤–∞–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- ‚ùå –ó–∞—Ç—Ä—É–¥–Ω—è–µ—Ç –æ—Ç–ª–∞–¥–∫—É
- ‚ùå –ù–∞—Ä—É—à–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚ùå –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∑–∞–≤–∏—Å–∞–Ω–∏—è–º

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. **app/training_dialog.py** ‚úÖ
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** 10 –≥–æ–ª—ã—Ö except –±–ª–æ–∫–æ–≤

| –°—Ç—Ä–æ–∫–∞ | –ö–æ–Ω—Ç–µ–∫—Å—Ç | –†–µ—à–µ–Ω–∏–µ |
|--------|----------|---------|
| 370 | –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –±–∞–ª–ª–∞ –∫–∞—á–µ—Å—Ç–≤–∞ | `except (KeyError, TypeError, ValueError, ZeroDivisionError)` |
| 2483 | –ê–Ω–∞–ª–∏–∑ PDF —Ñ–∞–π–ª–æ–≤ | `except (IOError, OSError, KeyError, Exception)` |
| 3622 | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ worker | `except (RuntimeError, AttributeError)` |
| 4020, 4107, 4114 | –°–±—Ä–æ—Å UI | `except (RuntimeError, AttributeError, Exception)` |
| 4485 | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ | `except (IOError, OSError, RuntimeError)` |

### 2. **app/training/donut_trainer.py** ‚úÖ
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** 2 –≥–æ–ª—ã—Ö except –±–ª–æ–∫–∞

| –°—Ç—Ä–æ–∫–∞ | –ö–æ–Ω—Ç–µ–∫—Å—Ç | –†–µ—à–µ–Ω–∏–µ |
|--------|----------|---------|
| 897 | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | `except (AttributeError, OSError)` |
| 1343 | Gradient checkpointing | `except (AttributeError, RuntimeError)` |

### 3. **app/main_window.py** ‚úÖ
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** 1 –≥–æ–ª—ã–π except –±–ª–æ–∫

| –°—Ç—Ä–æ–∫–∞ | –ö–æ–Ω—Ç–µ–∫—Å—Ç | –†–µ—à–µ–Ω–∏–µ |
|--------|----------|---------|
| 2592 | –ß—Ç–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏ | `except (IOError, json.JSONDecodeError, KeyError)` |

### 4. **app/processing_engine.py** ‚úÖ
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** 2 –≥–æ–ª—ã—Ö except –±–ª–æ–∫–∞

| –°—Ç—Ä–æ–∫–∞ | –ö–æ–Ω—Ç–µ–∫—Å—Ç | –†–µ—à–µ–Ω–∏–µ |
|--------|----------|---------|
| 624 | –£–¥–∞–ª–µ–Ω–∏–µ temp –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ | `except (OSError, PermissionError)` |
| 642 | –ü–æ–ª—É—á–µ–Ω–∏–µ —è–∑—ã–∫–æ–≤ Tesseract | `except (pytesseract.TesseractError, RuntimeError, OSError)` |

---

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
- ‚úÖ **15 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤** –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- ‚úÖ **training_dialog.py** - 10 –±–ª–æ–∫–æ–≤
- ‚úÖ **main_window.py** - 1 –±–ª–æ–∫
- ‚úÖ **processing_engine.py** - 2 –±–ª–æ–∫–∞
- ‚úÖ **donut_trainer.py** - 2 –±–ª–æ–∫–∞

### –û—Å—Ç–∞–ª–æ—Å—å –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö:
- ‚ö†Ô∏è **~32 –±–ª–æ–∫–∞** –≤ –º–µ–Ω–µ–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö:
  - `app/training/data_preparator_backup.py` - 9 (backup —Ñ–∞–π–ª)
  - `app/training/` –º–æ–¥—É–ª–∏ - 18
  - –ü–ª–∞–≥–∏–Ω—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π - 8
  - Core –º–æ–¥—É–ª–∏ - 7

---

## üéØ –ü—Ä–∏–Ω—Ü–∏–ø—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:
```python
# –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
try:
    risky_operation()
except (ValueError, TypeError, KeyError) as e:
    logger.error(f"–û—à–∏–±–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏: {e}", exc_info=True)
    # Graceful handling
```

### ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:
```python
# –ì–æ–ª—ã–π except - –ª–æ–≤–∏—Ç –í–°–ï
try:
    risky_operation()
except:
    pass  # –°–∫—Ä—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏!
```

---

## üîç –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ü—Ä–∏–º–µ—Ä 1: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –±–∞–ª–ª–∞ –∫–∞—á–µ—Å—Ç–≤–∞
```python
# –ë–´–õ–û:
except:
    return 0.0

# –°–¢–ê–õ–û:
except (KeyError, TypeError, ValueError, ZeroDivisionError) as e:
    logging.error(f"–û—à–∏–±–∫–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –æ–±—â–µ–≥–æ –±–∞–ª–ª–∞ –∫–∞—á–µ—Å—Ç–≤–∞: {e}", exc_info=True)
    return 0.0
```

### –ü—Ä–∏–º–µ—Ä 2: –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏
```python
# –ë–´–õ–û:
except:
    pdf_stats['without_text'] += 1

# –°–¢–ê–õ–û:
except (IOError, OSError, KeyError, Exception) as e:
    logging.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å PDF {pdf_file}: {e}")
    pdf_stats['without_text'] += 1
```

### –ü—Ä–∏–º–µ—Ä 3: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—Ç–æ–∫–æ–≤
```python
# –ë–´–õ–û:
except:
    pass

# –°–¢–ê–õ–û:
except (RuntimeError, AttributeError) as e:
    logging.warning(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ worker: {e}")
```

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–æ—Å—Ç–∞–ª–æ—Å—å): ‚ö†Ô∏è
- [ ] `app/training/universal_dataset_parser.py` - 4 –±–ª–æ–∫–∞
- [ ] `app/training/enhanced_trocr_dataset_preparator.py` - 4 –±–ª–æ–∫–∞
- [ ] `app/training/advanced_data_validator.py` - 3 –±–ª–æ–∫–∞
- [ ] `app/training/trocr_dataset_preparator.py` - 3 –±–ª–æ–∫–∞

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–º–µ–Ω–µ–µ –∫—Ä–∏—Ç–∏—á–Ω–æ):
- [ ] –ü–ª–∞–≥–∏–Ω—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π (Paperless, 1C ERP) - 8 –±–ª–æ–∫–æ–≤
- [ ] Core –º–æ–¥—É–ª–∏ (performance_monitor, optimization) - 7 –±–ª–æ–∫–æ–≤

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å):
- [ ] `app/training/data_preparator_backup.py` - 9 –±–ª–æ–∫–æ–≤ (—ç—Ç–æ backup!)

---

## ‚ú® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- ‚úÖ –ù–µ —Å–∫—Ä—ã–≤–∞—é—Ç—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ (`KeyboardInterrupt`, `SystemExit`)
- ‚úÖ –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- ‚úÖ Graceful degradation –≤–º–µ—Å—Ç–æ –º–æ–ª—á–∞–ª–∏–≤—ã—Ö —Å–±–æ–µ–≤

### –û—Ç–ª–∞–¥–∫–∞:
- ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- ‚úÖ Stack traces –≤ –ª–æ–≥–∞—Ö
- ‚úÖ –õ–µ–≥—á–µ –Ω–∞–π—Ç–∏ –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–æ–±–ª–µ–º—ã

### Maintainability:
- ‚úÖ –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –æ–∂–∏–¥–∞–µ–º—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ edge cases
- ‚úÖ –õ—É—á—à–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞

---

## üéâ –ò—Ç–æ–≥–∏

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ:
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ **15 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö except –±–ª–æ–∫–æ–≤** –≤ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
- ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—É—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞—â–∏—â–µ–Ω—ã
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
**–ö–æ–¥ —Å—Ç–∞–ª –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ, –Ω–∞–¥–µ–∂–Ω–µ–µ –∏ –ª–µ–≥—á–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ!** üöÄ

---

*–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã: 02.10.2024*  
*–°—Ç–∞—Ç—É—Å: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã*  
*–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ MainWindow –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã*

